<app-navbar></app-navbar>

<mat-tab-group class="mat-elevation-z8" (selectedTabChange)="tabChanged($event)">
    <mat-tab label="My Books">
        <section *ngIf="noCheckedBooks" class="dialog">
            No checked books available to show
        </section>

        <section *ngIf="!noCheckedBooks" class="positioning">
            <mat-form-field appearance="standard" style="width: 100%;display: inline-flex; justify-content: end;">
                <mat-icon matPrefix style="padding: 0px; font-size: medium; font-weight: bold;">search</mat-icon>
                <input matInput (keyup)="filterBooksWithTab(filter.value)" matInput placeholder="Search" #filter>
            </mat-form-field>

            <table mat-table [dataSource]="checkedBooksUI" class="mat-elevation-z8">
                <ng-container matColumnDef="id">
                    <th mat-header-cell *matHeaderCellDef> No. </th>
                    <td mat-cell *matCellDef="let element;index as i"> {{i+1}} </td>
                </ng-container>

                <ng-container matColumnDef="name">
                    <th mat-header-cell *matHeaderCellDef> Name </th>
                    <td mat-cell *matCellDef="let element"> {{element.name}} </td>
                </ng-container>

                <ng-container matColumnDef="pages">
                    <th mat-header-cell *matHeaderCellDef> Pages </th>
                    <td mat-cell *matCellDef="let element"> {{element.pages}} </td>
                </ng-container>

                <ng-container matColumnDef="subject">
                    <th mat-header-cell *matHeaderCellDef> Subject </th>
                    <td mat-cell *matCellDef="let element"> {{element.subject}} </td>
                </ng-container>

                <ng-container matColumnDef="checked">
                    <th mat-header-cell *matHeaderCellDef> checked</th>
                    <td mat-cell *matCellDef="let element">
                        <mat-checkbox disabled="true" color="primary" [(ngModel)]="element.checked"
                            (change)="$event ? toggleCheck() : null">
                        </mat-checkbox>
                    </td>
                </ng-container>

                <tr mat-header-row *matHeaderRowDef="displayedColumnsForChecked; sticky:true;"></tr>
                <tr mat-row *matRowDef="let row; columns: displayedColumnsForChecked;"></tr>
            </table>
        </section>
    </mat-tab>

    <mat-tab label="Inventory">
        <section *ngIf="noUnCheckedBooks" class="dialog">
            No books available to show
        </section>

        <section *ngIf="!noUnCheckedBooks" class="positioning">
            <mat-form-field appearance="standard"
                style="padding: 0px; width: 100%;display: inline-flex; justify-content: end;">
                <mat-icon matPrefix style="padding: 0px; font-size: medium; font-weight: bold;">search</mat-icon>
                <input matInput (keyup)="filterBooksWithTab(filter.value)" matInput placeholder="Search" #filter>
            </mat-form-field>

            <table mat-table [dataSource]="unCheckedBooksUI" class="mat-elevation-z8">
                <ng-container matColumnDef="id">
                    <th mat-header-cell *matHeaderCellDef> No. </th>
                    <td mat-cell *matCellDef="let element;index as i"> {{i+1}} </td>
                </ng-container>

                <ng-container matColumnDef="name">
                    <th mat-header-cell *matHeaderCellDef> Name </th>
                    <td mat-cell *matCellDef="let element"> {{element.name}} </td>
                </ng-container>

                <ng-container matColumnDef="pages">
                    <th mat-header-cell *matHeaderCellDef> Pages </th>
                    <td mat-cell *matCellDef="let element"> {{element.pages}} </td>
                </ng-container>

                <ng-container matColumnDef="subject">
                    <th mat-header-cell *matHeaderCellDef> Subject </th>
                    <td mat-cell *matCellDef="let element"> {{element.subject}} </td>
                </ng-container>

                <ng-container matColumnDef="availability">
                    <th mat-header-cell *matHeaderCellDef> Availability </th>
                    <td mat-cell *matCellDef="let element"> {{element.available+'/'+element.total}} </td>
                </ng-container>

                <ng-container matColumnDef="assign" *ngIf="user.admin">
                    <th mat-header-cell *matHeaderCellDef> Assign </th>
                    <td mat-cell *matCellDef="let element">
                        <button mat-icon-button (click)="openDialogToAssign(element)" #assignButton>
                            <mat-icon>person_add</mat-icon>
                        </button>
                        <!-- <mat-form-field appearance="fill" #assignSelect>
                            <mat-label>User Name / ID</mat-label>
                            <input type="text" placeholder="Pick one" aria-label="Number" matInput
                                [formControl]="ctrlForUserSelect" [matAutocomplete]="auto">
                            <mat-autocomplete #auto="matAutocomplete">
                                <mat-option *ngFor="let option of filteredUsersToAssign | async;"
                                    [value]="option">
                                    {{option}}
                                </mat-option>
                            </mat-autocomplete>
                        </mat-form-field> -->
                    </td>
                </ng-container>

                <ng-container matColumnDef="return" *ngIf="user.admin">
                    <th mat-header-cell *matHeaderCellDef> Return </th>
                    <td mat-cell *matCellDef="let element">
                        <button mat-icon-button (click)="openDialogToReturn(element)" #returnButton>
                            <mat-icon>person_remove_alt_1</mat-icon>
                        </button>
                    </td>
                </ng-container>

                <!-- <ng-container matColumnDef="checked">
                    <th mat-header-cell *matHeaderCellDef> checked</th>
                    <td mat-cell *matCellDef="let element">
                        <mat-checkbox disabled="true" color="primary" [(ngModel)]="element.checked"
                            (change)="$event ? toggleCheck() : null">
                        </mat-checkbox>
                    </td>
                </ng-container> -->

                <tr mat-header-row *matHeaderRowDef="displayedColumnsForRemaining; sticky:true;"></tr>
                <tr mat-row *matRowDef="let row; columns: displayedColumnsForRemaining; index as i"></tr>
            </table>
        </section>
    </mat-tab>
</mat-tab-group>